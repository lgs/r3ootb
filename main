project_name = ARGV[0]
puts "Il nome del progetto e' #{project_name}"

log 'main template'
  #apply 'http://gist.github.com/378520.txt'
  apply 'http://github.com/lgs/r3ootb/raw/master/templates/base-rails-3.0.0.beta4'

  #apply 'http://gist.github.com/378517.txt'
  apply 'http://github.com/lgs/r3ootb/raw/master/templates/devise'

log 'Building layout'
  inside('public') do
    run('rm index.html')
  end
  print "Now you have 3 choices, type 'n' to skip to the next: \n
  - having Blueprint CSS with a simple Boks template \n
  - having Blueprint CSS without template \n
  - having no Blueprint CSS nor template at all \n"
  if yes?("\nCreate a Boks Blueprint CSS ? (y/n)")
    get "http://github.com/lgs/r3ootb/raw/master/layouts/blueprint-boks/css/fancy-type.css", "public/stylesheets/fancy-type.css"
    get "http://github.com/lgs/r3ootb/raw/master/layouts/blueprint-boks/css/screen.css", "public/stylesheets/screen.css"
    get "http://github.com/lgs/r3ootb/raw/master/layouts/blueprint-boks/css/print.css", "public/stylesheets/print.css"
    get "http://github.com/lgs/r3ootb/raw/master/layouts/blueprint-boks/css/ie.css", "public/stylesheets/ie.css"

    inject_into_file "app/views/layouts/application.html.erb", :after => "<body>" do
      "\n<div class=\"container showgrid\">\n  <div class=\"span-24 last\" id=\"header\">\n    <div class=\"span-7\" id=\"Logo\"><h1>Fantastic Logo</h1></div>\n    <div class=\"span-17 last\" id=\"right-header\">\n        <% if user_signed_in? %>\n          <%= link_to \"settings\", edit_user_registration_path %> |\n          <%= link_to \"logout\", destroy_user_session_path %>\n         <% else %>\n           <%= link_to \"login\", new_user_session_path %>\n         <% end %>\n     </div>\n  </div>\n"
    end

    inject_into_file "app/views/layouts/application.html.erb", :before => "</body>" do
      "\n  <div class=\"clear span-24 last\" id=\"footer\">Released under the MIT license</div>\n</div>\n"
    end

    run 'rm app/views/home/index.html.erb'
    get "http://github.com/lgs/r3ootb/raw/master/layouts/blueprint-boks/index.html.erb", "app/views/home/index.html.erb"
  else
    if yes?("\nCreate a white Blueprint CSS environment without template ? (y/n)")
      apply 'http://github.com/lgs/r3ootb/raw/master/templates/blueprint-css'
    end
  end

if yes?("\nDeploy on Heroku ? (y/n)")

  apply 'http://github.com/lgs/r3ootb/raw/master/templates/git-init'

  puts 'heroku create --stack bamboo-ree-1.8.7'
  run 'heroku create --stack bamboo-ree-1.8.7'

  puts 'git push heroku master'
  run 'git push heroku master'

  puts 'heroku rake db:migrate'
  run 'heroku rake db:migrate'
end

#log 'rails-footnotes:  yes, you want it only in development'
#  inject_into_file "config/environments/development.rb", :before => "end" do
#
#    'config.gem "rails-footnotes"'
#    'if defined?(Footnotes)'
#    "  Footnotes::Filter.prefix = 'txmt://open?url=file://%s&amp;line=%d&amp;column=%d'"
#    'end'
#
#  end


